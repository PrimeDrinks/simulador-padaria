<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8" />
  <title>Simulador de Viabilidade - Padaria (Pão Congelado)</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <style>
    * { box-sizing: border-box; }
    body {
      font-family: system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif;
      background: #f5f5f5;
      margin: 0;
      padding: 1.5rem;
      color: #222;
    }
    h1 {
      font-size: 1.5rem;
      margin-bottom: 0.5rem;
    }
    h2 {
      margin-top: 1.5rem;
      margin-bottom: 0.5rem;
      font-size: 1.1rem;
      border-left: 4px solid #f0b400;
      padding-left: 0.5rem;
    }
    .container {
      max-width: 1120px;
      margin: 0 auto;
      background: #fff;
      border-radius: 12px;
      padding: 1.5rem;
      box-shadow: 0 4px 16px rgba(0,0,0,0.06);
    }
    .grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(260px, 1fr));
      gap: 0.75rem 1rem;
      margin-bottom: 1rem;
    }
    .field {
      display: flex;
      flex-direction: column;
      gap: 0.2rem;
    }
    .field label {
      font-size: 0.85rem;
      font-weight: 600;
      color: #444;
    }
    .field small {
      font-size: 0.7rem;
      color: #777;
    }
    .field input {
      padding: 0.35rem 0.5rem;
      border-radius: 6px;
      border: 1px solid #ccc;
      font-size: 0.9rem;
      width: 100%;
    }
    .field input:focus {
      outline: none;
      border-color: #f0b400;
      box-shadow: 0 0 0 2px rgba(240, 180, 0, 0.2);
    }
    .outputs {
      margin-top: 1rem;
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
      gap: 0.75rem;
    }
    .card {
      background: #fafafa;
      border-radius: 10px;
      padding: 0.75rem 0.9rem;
      border: 1px solid #eee;
    }
    .card strong {
      display: block;
      font-size: 0.85rem;
      color: #555;
      margin-bottom: 0.2rem;
    }
    .card span.value {
      font-size: 1rem;
      font-weight: 700;
      color: #222;
    }
    .card span.desc {
      display: block;
      font-size: 0.7rem;
      color: #777;
      margin-top: 0.15rem;
    }
    .tag {
      display: inline-block;
      font-size: 0.7rem;
      background: #f0b400;
      color: #fff;
      padding: 0.15rem 0.4rem;
      border-radius: 999px;
      margin-left: 0.4rem;
    }
    .alerta {
      margin-top: 0.5rem;
      padding: 0.5rem 0.75rem;
      border-radius: 8px;
      font-size: 0.8rem;
    }
    .alerta-ok {
      background: #e4f7e7;
      border: 1px solid #7bc47f;
      color: #285c2a;
    }
    .alerta-erro {
      background: #ffe9e7;
      border: 1px solid #ff6a5b;
      color: #7b1f16;
    }
    .footer-note {
      margin-top: 1rem;
      font-size: 0.7rem;
      color: #999;
    }
  </style>
</head>
<body>
  <div class="container">
    <h1>Simulador de Viabilidade – Padaria de Pão Congelado</h1>
    <p style="font-size:0.8rem;color:#555;">
      Altere os valores e a produção diária em sacas. Os resultados são recalculados automaticamente.
      (Pode digitar com vírgula: ex. <b>2.600,00</b> ou <b>2600</b>).
    </p>

    <h2>1. Produção e Preço</h2>
    <div class="grid">
      <div class="field">
        <label for="paesPorSaca">Pães por saca</label>
        <input id="paesPorSaca" type="text" value="1550" />
        <small>Quantidade de pães produzidos com 1 saca de farinha.</small>
      </div>
      <div class="field">
        <label for="precoPao">Preço de venda por pão (R$)</label>
        <input id="precoPao" type="text" value="0,0" />
        <small>Preço unitário cobrado do cliente.</small>
      </div>
      <div class="field">
        <label for="imposto">Imposto sobre receita (fração)</label>
        <input id="imposto" type="text" value="0,0" />
        <small>Ex.: 6% = 0,06 &nbsp; (Simples Nacional).</small>
      </div>
    </div>

    <h2>2. Custos variáveis por saca de massa</h2>
    <div class="grid">
      <div class="field">
        <label for="farinha">Farinha (R$/saca)</label>
        <input id="farinha" type="text" value="0,0" />
      </div>
      <div class="field">
        <label for="reforcador">Reforçador (R$/saca)</label>
        <input id="reforcador" type="text" value="0,0" />
      </div>
      <div class="field">
        <label for="oleo">Óleo (R$/saca)</label>
        <input id="oleo" type="text" value="0,0" />
      </div>
      <div class="field">
        <label for="fermento">Fermento (R$/saca)</label>
        <input id="fermento" type="text" value="0,0" />
      </div>
      <div class="field">
        <label for="gelo">Gelo (R$/saca)</label>
        <input id="gelo" type="text" value="0,0" />
      </div>
      <div class="field">
        <label for="acucarSal">Açúcar/Sal (R$/saca)</label>
        <input id="acucarSal" type="text" value="0,0" />
      </div>
      <div class="field">
        <label for="embalagem">Embalagem (R$/saca)</label>
        <input id="embalagem" type="text" value="0,0" />
      </div>
      <div class="field">
        <label for="maoObra">Mão de obra (R$/saca)</label>
        <input id="maoObra" type="text" value="0,0" />
      </div>
    </div>

    <h2>3. Custos fixos mensais</h2>
    <div class="grid">
      <div class="field">
        <label for="aluguel">Aluguel (R$/mês)</label>
        <input id="aluguel" type="text" value="0,00" />
      </div>
      <div class="field">
        <label for="energia">Energia (R$/mês)</label>
        <input id="energia" type="text" value="0,00" />
      </div>
      <div class="field">
        <label for="agua">Água (R$/mês)</label>
        <input id="agua" type="text" value="0,00" />
      </div>
      <div class="field">
        <label for="internet">Internet (R$/mês)</label>
        <input id="internet" type="text" value="0,00" />
      </div>
      <div class="field">
        <label for="contador">Contador (R$/mês)</label>
        <input id="contador" type="text" value="0,00" />
      </div>
      <div class="field">
        <label for="metaLucro">Meta de lucro líquido (R$/mês)</label>
        <input id="metaLucro" type="text" value="0,00" />
      </div>
    </div>

    <h2>4. Capacidade e Produção</h2>
    <div class="grid">
      <div class="field">
        <label for="horasDia">Horas por dia (capacidade)</label>
        <input id="horasDia" type="text" value="9" />
        <small>Capacidade máxima teórica (1 saca = 1 hora).</small>
      </div>
      <div class="field">
        <label for="diasMes">Dias por mês</label>
        <input id="diasMes" type="text" value="24" />
      </div>
      <div class="field">
        <label for="sacasDia">Produção planejada (sacas/dia)</label>
        <input id="sacasDia" type="text" value="1" />
        <small>Este campo é o “botão de volume” da produção.</small>
      </div>
    </div>

    <div id="capacidadeInfo" class="alerta alerta-ok" style="display:none;"></div>

    <h2>5. Resultados (por pão e por mês)</h2>
    <div class="outputs">
      <div class="card">
        <strong>Custo variável por saca (R$)</strong>
        <span class="value" id="custoVarSaca">-</span>
        <span class="desc">Insumos + embalagem + mão de obra.</span>
      </div>
      <div class="card">
        <strong>Custo variável por pão (R$)</strong>
        <span class="value" id="custoVarPao">-</span>
      </div>
      <div class="card">
        <strong>Custo fixo por mês (R$)</strong>
        <span class="value" id="custoFixoMes">-</span>
      </div>
      <div class="card">
        <strong>Produção mensal (pães)</strong>
        <span class="value" id="paesMes">-</span>
      </div>
      <div class="card">
        <strong>Custo fixo por pão (R$)</strong>
        <span class="value" id="custoFixoPao">-</span>
        <span class="desc">Diminui quando a produção aumenta.</span>
      </div>
      <div class="card">
        <strong>Preço líquido por pão (R$)</strong>
        <span class="value" id="precoLiquidoPao">-</span>
        <span class="desc">Após desconto de impostos (6%).</span>
      </div>
      <div class="card">
        <strong>Margem de contribuição por pão (R$)</strong>
        <span class="value" id="margemContribPao">-</span>
        <span class="desc">Preço líquido − custo variável.</span>
      </div>
      <div class="card">
        <strong>Custo total por pão (R$)</strong>
        <span class="value" id="custoTotalPao">-</span>
        <span class="desc">Variável + fixo unitário.</span>
      </div>
      <div class="card">
        <strong>Lucro líquido por pão (R$)</strong>
        <span class="value" id="lucroPao">-</span>
        <span class="desc">Preço líquido − custo total.</span>
      </div>
      <div class="card">
        <strong>Receita bruta mensal (R$)</strong>
        <span class="value" id="receitaBruta">-</span>
      </div>
      <div class="card">
        <strong>Impostos mensais (R$)</strong>
        <span class="value" id="impostosMes">-</span>
      </div>
      <div class="card">
        <strong>Receita líquida mensal (R$)</strong>
        <span class="value" id="receitaLiquida">-</span>
      </div>
      <div class="card">
        <strong>Custo variável total (R$)</strong>
        <span class="value" id="custoVarTotal">-</span>
      </div>
      <div class="card">
        <strong>Lucro de contribuição (R$)</strong>
        <span class="value" id="lucroContrib">-</span>
        <span class="desc">Receita líquida − custos variáveis.</span>
      </div>
      <div class="card">
        <strong>Lucro líquido mensal (R$)</strong>
        <span class="value" id="lucroLiquidoMes">-</span>
        <span class="desc">Após fixos e impostos.</span>
      </div>
      <div class="card">
        <strong>Ponto de equilíbrio (pães/mês)</strong>
        <span class="value" id="pePaesMes">-</span>
        <span class="desc">Pães/mês para cobrir os fixos.</span>
      </div>
      <div class="card">
        <strong>Pães p/ meta + fixos (un)</strong>
        <span class="value" id="paesMetaFixos">-</span>
      </div>
      <div class="card">
        <strong>Sacas p/ meta + fixos (un)</strong>
        <span class="value" id="sacasMetaFixos">-</span>
      </div>
    </div>

    <p class="footer-note">
      * Este simulador é apenas uma ferramenta de apoio. Sempre confirme os números com seu contador.
    </p>
  </div>

  <script>
    function parseNumber(str) {
      if (!str) return 0;
      // remove espaços
      str = String(str).trim();
      // troca separador PT-BR para padrão JS
      str = str.replace(/\./g, '').replace(',', '.');
      const n = parseFloat(str);
      return isNaN(n) ? 0 : n;
    }

    function fmtMoney(n, decimals = 2) {
      return n.toLocaleString('pt-BR', {
        minimumFractionDigits: decimals,
        maximumFractionDigits: decimals
      });
    }

    function fmtInt(n) {
      return Math.round(n).toLocaleString('pt-BR');
    }

    function calcular() {
      const paesPorSaca = parseNumber(document.getElementById('paesPorSaca').value);
      const precoPao    = parseNumber(document.getElementById('precoPao').value);
      const imposto     = parseNumber(document.getElementById('imposto').value);

      const farinha   = parseNumber(document.getElementById('farinha').value);
      const reforcador= parseNumber(document.getElementById('reforcador').value);
      const oleo      = parseNumber(document.getElementById('oleo').value);
      const fermento  = parseNumber(document.getElementById('fermento').value);
      const gelo      = parseNumber(document.getElementById('gelo').value);
      const acucarSal = parseNumber(document.getElementById('acucarSal').value);
      const embalagem = parseNumber(document.getElementById('embalagem').value);
      const maoObra   = parseNumber(document.getElementById('maoObra').value);

      const aluguel   = parseNumber(document.getElementById('aluguel').value);
      const energia   = parseNumber(document.getElementById('energia').value);
      const agua      = parseNumber(document.getElementById('agua').value);
      const internet  = parseNumber(document.getElementById('internet').value);
      const contador  = parseNumber(document.getElementById('contador').value);
      const metaLucro = parseNumber(document.getElementById('metaLucro').value);

      const horasDia  = parseNumber(document.getElementById('horasDia').value);
      const diasMes   = parseNumber(document.getElementById('diasMes').value);
      const sacasDia  = parseNumber(document.getElementById('sacasDia').value);

      // Produção
      const sacasMes = sacasDia * diasMes;
      const paesMes  = sacasMes * paesPorSaca;

      // Custos variáveis
      const custoVarSaca = farinha + reforcador + oleo + fermento + gelo + acucarSal + embalagem + maoObra;
      const custoVarPao  = paesPorSaca > 0 ? custoVarSaca / paesPorSaca : 0;

      // Fixos
      const custoFixoMes = aluguel + energia + agua + internet + contador;
      const custoFixoPao = paesMes > 0 ? custoFixoMes / paesMes : 0;

      // Preço líquido, margens
      const precoLiquidoPao = precoPao * (1 - imposto);
      const margemContribPao = precoLiquidoPao - custoVarPao;
      const custoTotalPao = custoVarPao + custoFixoPao;
      const lucroPao = precoLiquidoPao - custoTotalPao;

      // Receita e lucros mensais
      const receitaBruta = precoPao * paesMes;
      const impostosMes  = receitaBruta * imposto;
      const receitaLiquida = receitaBruta - impostosMes;
      const custoVarTotal  = custoVarPao * paesMes;
      const lucroContrib   = receitaLiquida - custoVarTotal;
      const lucroLiquidoMes = lucroContrib - custoFixoMes;

      // Break-even
      let pePaesMes = "—";
      let paesMetaFixos = "—";
      let sacasMetaFixos = "—";

      if (margemContribPao > 0) {
        pePaesMes = custoFixoMes / margemContribPao;
        paesMetaFixos = (metaLucro + custoFixoMes) / margemContribPao;
        sacasMetaFixos = paesMetaFixos / paesPorSaca;
      }

      // Capacidade
      const capacidadeMaxSacasDia = horasDia; // 1 saca = 1h
      const capInfo = document.getElementById('capacidadeInfo');
      if (sacasDia > capacidadeMaxSacasDia && capacidadeMaxSacasDia > 0) {
        capInfo.className = "alerta alerta-erro";
        capInfo.style.display = "block";
        capInfo.textContent =
          `Produção planejada de ${sacasDia.toLocaleString('pt-BR')} sacas/dia ultrapassa ` +
          `a capacidade de ${capacidadeMaxSacasDia.toLocaleString('pt-BR')} sacas/dia (1 saca = 1h).`;
      } else if (sacasDia > 0) {
        const uso = capacidadeMaxSacasDia > 0 ? (sacasDia / capacidadeMaxSacasDia) * 100 : 0;
        capInfo.className = "alerta alerta-ok";
        capInfo.style.display = "block";
        capInfo.textContent =
          `Capacidade utilizada: ${uso.toFixed(1)}% (${sacasDia.toLocaleString('pt-BR')} sacas/dia ` +
          `de um máximo de ${capacidadeMaxSacasDia.toLocaleString('pt-BR')}).`;
      } else {
        capInfo.style.display = "none";
      }

      // Saída
      document.getElementById('custoVarSaca').textContent   = "R$ " + fmtMoney(custoVarSaca);
      document.getElementById('custoVarPao').textContent    = "R$ " + fmtMoney(custoVarPao, 4);
      document.getElementById('custoFixoMes').textContent   = "R$ " + fmtMoney(custoFixoMes);
      document.getElementById('paesMes').textContent        = paesMes > 0 ? fmtInt(paesMes) : "—";
      document.getElementById('custoFixoPao').textContent   = "R$ " + fmtMoney(custoFixoPao, 4);
      document.getElementById('precoLiquidoPao').textContent= "R$ " + fmtMoney(precoLiquidoPao, 4);
      document.getElementById('margemContribPao').textContent= "R$ " + fmtMoney(margemContribPao, 4);
      document.getElementById('custoTotalPao').textContent  = "R$ " + fmtMoney(custoTotalPao, 4);
      document.getElementById('lucroPao').textContent       = "R$ " + fmtMoney(lucroPao, 4);
      document.getElementById('receitaBruta').textContent   = "R$ " + fmtMoney(receitaBruta);
      document.getElementById('impostosMes').textContent    = "R$ " + fmtMoney(impostosMes);
      document.getElementById('receitaLiquida').textContent = "R$ " + fmtMoney(receitaLiquida);
      document.getElementById('custoVarTotal').textContent  = "R$ " + fmtMoney(custoVarTotal);
      document.getElementById('lucroContrib').textContent   = "R$ " + fmtMoney(lucroContrib);
      document.getElementById('lucroLiquidoMes').textContent= "R$ " + fmtMoney(lucroLiquidoMes);

      document.getElementById('pePaesMes').textContent =
        typeof pePaesMes === "number" ? fmtInt(pePaesMes) : "—";

      document.getElementById('paesMetaFixos').textContent =
        typeof paesMetaFixos === "number" ? fmtInt(paesMetaFixos) : "—";

      document.getElementById('sacasMetaFixos').textContent =
        typeof sacasMetaFixos === "number" ? fmtMoney(sacasMetaFixos, 2) : "—";
    }

    // Listener global de mudança
    document.addEventListener('input', function (e) {
      if (e.target.tagName === 'INPUT') {
        calcular();
      }
    });

    // Primeira execução
    calcular();
  </script>
</body>
</html>
